#:kivy 2.2.1
#:import all_timezones pytz.all_timezones

<ClockScreen>:
    FloatLayout:
        Image:
            id: sky_image
            source: 'sky.png'  
            size_hint: 1, 1
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
        Label:
            text: root.time
            font_size: min(root.width, root.height) * 0.12  # 10% der kleinsten Seite (anpassbar)
            color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
            size_hint: 1, 0.9
            pos_hint: {'center_x': 0.5, 'center_y': 0.8}
        FocusButton:
            text: '⚙'
            font_name: 'DejaVuSans.ttf'
            font_size: min(root.width, root.height) * 0.03  # 5% der kleinsten Seite
            size: min(root.width, root.height) * 0.05, min(root.width, root.height) * 0.05
            size_hint: None, None
            pos_hint: {'top': 1, 'right': 1}
            on_press: root.switch_to_settings()

<SettingsScreen>:
    FloatLayout:
        Label:
            text: 'Einstellungen'
            font_size: 50
            color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
            pos_hint: {'top': 1, 'center_x': 0.5}
            size_hint: None, None
            height: 50
        GridLayout:
            cols: 2
            row_default_height: 30
            row_force_default: True
            spacing: 5
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            size_hint: 0.9, 0.6
            Label:
                text: 'GPS-Koordinaten (lat, lon):'
                color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                size_hint_y: None
                height: 30
            TextInput:
                text: app.gps_coords
                multiline: False
                size_hint_y: None
                height: 30
                foreground_color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                background_color: (0, 0, 0, 1) if app.night_mode else (1, 1, 1, 1)
                on_text: app.gps_coords = self.text
                canvas.before:
                    Color:
                        rgba: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                    Line:
                        width: 1
                        rectangle: self.x + 0, self.y + 1, self.width - 0, self.height - 1

            Label:
                text: 'Stündlich GPS-Daten holen'
                color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                size_hint_y: None
                height: 30
            CheckBox:
                active: app.use_gps_hourly
                color: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                size_hint_y: None
                height: 30
                on_active: app.use_gps_hourly = self.active
                canvas.before:
                    Color:
                        rgba: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                    Line:
                        width: 1
                        rectangle: self.x + 0, self.y + 1, self.width - 0, self.height - 1
            Label:
                text: 'Zeitzone'
                color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                size_hint_y: None
                height: 30
            Spinner:
                text: app.timezone
                values: all_timezones
                size_hint_y: None
                height: 30
                canvas.before:
                    Color:
                        rgba: (0.9, 0.9, 0.9, 1) if not app.night_mode else (0.2, 0.2, 0.2, 1)
                    Rectangle:
                        pos: self.pos
                        size: self.size
                text_color: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                on_text: app.timezone = self.text
            Label:
                text: '24-Stunden-Format'
                color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                size_hint_y: None
                height: 30
            CheckBox:
                active: app.use_24_hour
                color: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                size_hint_y: None
                height: 40
                on_active: app.use_24_hour = self.active
                canvas.before:
                    Color:
                        rgba: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                    Line:
                        width: 1
                        rectangle: self.x + 2, self.y + 4, self.width - 0, self.height - 12
            Label:
                text: 'Dunkelmodus'
                color: (1, 1, 1, 1) if app.night_mode else (0, 0, 0, 1)
                size_hint_y: None
                height: 30
            CheckBox:
                id: dunkelmodus
                active: app.night_mode 
                on_active: app.night_mode = self.active
                color: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                size_hint_y: None
                height: 40
                on_active: app.night_mode = self.active
                canvas.before:
                    Color:
                        rgba: (0, 0, 0, 1) if not app.night_mode else (1, 1, 1, 1)
                    Line:
                        width: 1
                        rectangle: self.x + 2, self.y + 4, self.width - 0, self.height - 12
        FocusButton:
            text: '←'
            font_name: 'DejaVuSans.ttf'
            font_size: min(root.width, root.height) * 0.03  # 5% der kleinsten Seite
            size: min(root.width, root.height) * 0.05, min(root.width, root.height) * 0.05
            size_hint: None, None
            pos_hint: {'top': 1, 'right': 1}
            on_press: root.switch_to_clock()

